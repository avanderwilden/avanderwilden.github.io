"0","df_2 <- df_2 %>% "
"0","  mutate(source = case_when("
"0","    meta == 'meta' & google == 'google' ~ 'Multiple',"
"0","    meta == 'meta' & bing == 'bing' ~ 'Multiple',"
"0","    google == 'google' & bing == 'bing' ~ 'Multiple',"
"0","    meta == 'meta' & is.na(google) & is.na(bing) ~ 'Meta/FB',"
"0","    google == 'google' & is.na(meta) & is.na(bing) ~ 'Google',"
"0","    bing == 'bing' & is.na(google) & is.na(meta) ~ 'Bing',"
"0","    TRUE ~ 'Organic'"
"0","  )) %>% "
"0","  mutate(ch_status = ifelse(is.na(churn_date), 1,2),"
"0","         ch_time = case_when("
"0","           ch_status == 1 ~ difftime(today(),sub_start_date,"
"0","                                    units = 'days') %>% "
"0","             as.double(),"
"0","           TRUE ~ difftime(churn_date,sub_start_date,"
"0","                           units = 'days') %>% "
"0","             as.double()"
"0","         ),"
"0","         c_status = ifelse(is.na(canceled_at), 1, 2),"
"0","         c_time = case_when("
"0","           c_status == 1 ~ difftime(today(),sub_start_date,"
"0","                                    units = 'days') %>% "
"0","             as.double(),"
"0","           TRUE ~ difftime(canceled_at, sub_start_date,"
"0","                           units = 'days') %>% "
"0","             as.double()"
"0","         ),"
"0","         month_start = month(sub_start_date, label = T, abbr = F)) %>% "
"0","  filter(sub_start_date >= mdy('10/1/23')) %>% "
"0","  mutate(month_start = factor(month_start,"
"0","                              levels = c('June', 'July',"
"0","                                         'August', 'September', 'October',"
"0","                                         'November', 'December', 'January', 'February', 'March', 'April', 'May'))) %>% "
"0","  filter(sub_start_date >= mdy('1/1/23')) %>% "
"0","  filter(ch_time > 10)"
